FrictionTouch=function(t,e){if(!t)throw Error("FrictionTouch: element must be provided.");var r,n,o,i,a,s,f,u,c=["flickDuration","flickThreshold","friction","maxRotation","returnDuration"];for(var y in e=e||{},c)if(e[c[y]]<0)throw Error("FrictionTouch: "+c[y]+" must be non-negative.");var h=e.flickDuration||500,x=e.flickThreshold||1,m=e.friction||2,l=e.maxRotation||1.5,v=e.flickDuration||200;return d(),t.addEventListener("touchstart",g),t.addEventListener("touchmove",T),t.addEventListener("touchend",p),window.addEventListener("resize",d),{unbind:function(){t.removeEventListener("touchstart",g),t.removeEventListener("touchmove",T),t.removeEventListener("touchend",p),window.removeEventListener("resize",d)}};function d(){r=t.offsetWidth,n=t.offsetHeight,o=function(){var e=t,r=0,n=0;do{r+=e.offsetLeft,n+=e.offsetTop}while(e=e.offsetParent);return{x:r,y:n}}()}function g(e){e.preventDefault(),t.style.transition="";var f={x:(i={x:e.targetTouches[0].pageX,y:e.targetTouches[0].pageY}).x-o.x-r/2,y:i.y-o.y-n/2},u=Math.atan(f.x/f.y);a={x:Math.sign(f.x)*u-Math.sign(f.y)*Math.PI/2,y:Math.sign(f.y)*u},s={x:m*Math.abs(f.y)/(r*n),y:m*Math.abs(f.x)/(r*n)}}function T(t){t.preventDefault();var e={x:t.targetTouches[0].pageX-i.x,y:t.targetTouches[0].pageY-i.y},r=a.x*b(e.x*s.x,l)+a.y*b(e.y*s.y,l);E(t.targetTouches[0].pageX-o.x,t.targetTouches[0].pageY-o.y),w(e.x,e.y,r);var n=(new Date).getTime();(!u||n-u.time>30)&&(f=u,u={time:n,x:e.x,y:e.y,rotate:r})}function p(t){if(t.preventDefault(),f){var o=u.time-f.time||1/0,i={x:h*(u.x-f.x||0)/o,y:h*(u.y-f.y||0)/o,rotate:h*(u.rotate-f.rotate||0)/o},a=Math.abs(i.x/r)>x||Math.abs(i.y/n)>x;e.flicked&&e.flicked(a),a?M(i,h):M({x:0,y:0,rotate:0},v)}else M({x:0,y:0,rotate:0},v)}function M(r,n){t.style.transition=n+"ms linear",E(r.x,r.y),w(r.x,r.y,r.rotate),setTimeout((function(){t.style.transition="",e.resetPosition&&w(0,0,0),e.complete&&e.complete()}),n)}function w(e,r,n){var o="rotate("+n+"rad) translate("+e+"px, "+r+"px) translateZ(0)";t.style.webkitTransform=o,t.style.msTransform=o,t.style.transform=o}function E(e,r){var n=e+"px "+r+"px";t.style.webkitTransformOrigin=n,t.style.msTransformOrigin=n,t.style.transformOrigin=n}function b(t,e){return Math.max(Math.min(t,e),-1*e)}};
